import{f as l,h as V,i as R,o as d,a as p,b as c,t as b,u as o,r as E,w as Q,v as U,j as K,k as B,l as H,m as L,p as G,e as S,q as C,s as D,F as A,x as I,y as J,z as O,A as F,B as X,C as Y,T as Z,c as ee,D as te}from"./entry.08812e4a.js";const ne=()=>{l(0);const r=l(0);l(0);const n=V([]),e=l(0),a=l(0);l(0);const f=l(0);let g,t;return{startRecording:()=>{a.value=performance.now();let v=0;g=setInterval(()=>{n.push({time:v,wpm:r.value}),v++,console.log(f.value)},1e3),t=setInterval(()=>{const _=(performance.now()-a.value)/1e3;f.value=_})},stopRecording:()=>{clearInterval(t),clearInterval(g)},getResult:()=>({wpm:r,accuracy:e})}},oe={class:"container mx-auto my-12"},se={class:"result-header flex justify-center gap-20 text-center"},re={class:"group"},ce=c("div",{class:"text-2xl mb-5"}," wpm ",-1),ae={class:"text-7xl font-bold"},le={class:"group"},ie=c("div",{class:"text-2xl mb-5"}," accuracy ",-1),ue={class:"text-7xl font-bold"},de=R({__name:"Result",setup(r){const{getResult:n}=ne(),e=n();return(a,f)=>(d(),p("div",oe,[c("div",se,[c("div",re,[ce,c("div",ae,b(o(e).wpm),1)]),c("div",le,[ie,c("div",ue,b(o(e).accuracy)+"% ",1)])])]))}}),j=R({__name:"TextButton",props:{active:Boolean,icon:[String,Boolean]},emits:["click"],setup(r){return(n,e)=>(d(),p("a",{href:"#",class:K(["text-button inline-block",[r.active===!0?"active":""]]),onClick:e[0]||(e[0]=a=>n.$emit("click"))},[E(n.$slots,"icon",{},()=>[Q(c("div",{class:K(r.icon)},null,2),[[U,r.icon||n.$slots.icon]])]),c("span",null,[E(n.$slots,"default")])],2))}});const fe={class:"typing-settings flex justify-center"},pe={class:"settings-card flex-grow-0 rounded-sm shadow-lg my-5 text-sm p-1"},ve=c("h4",{class:"px-3 text-xl font-bold my-2"}," Typing Options ",-1),_e={class:"modes"},ge={class:"settings-list p-0 m-0 flex"},me=c("li",{class:"separator"},null,-1),ye=c("li",{class:"separator"},null,-1),he=R({__name:"Settings",setup(r){const n=B(),{config:e,configModes:a}=B(),{nextTheme:f,changeTheme:g,currentTheme:t}=H(),m=l([]),y=L(()=>n.options.language);G(()=>{$fetch("/languages/_list.json").then(i=>{m.value=i})});const h=i=>{console.log("language changed to ",i),n.options.language=i},v=()=>{const i=m.value.findIndex(_=>_.name===y.value),u=i+1>=m.value.length?0:i+1;h(m.value[u].name)};return(i,u)=>(d(),p("div",fe,[c("div",pe,[ve,c("div",_e,[c("ul",ge,[c("li",null,[S(j,{icon:"i-mdi:world",active:o(e).punctuation,onClick:v},{default:C(()=>[D(b(o(y)),1)]),_:1},8,["active"])]),c("li",null,[S(j,{icon:"i-mdi:palette",active:o(e).numbers,onClick:o(f)},{default:C(()=>[D(b(o(t)),1)]),_:1},8,["active","onClick"])]),me,(d(!0),p(A,null,I(o(a),(_,T)=>(d(),p("li",{key:T},[S(j,{icon:_.icon,active:o(e).mode===T,onClick:N=>o(e).mode=T},{default:C(()=>[D(b(T),1)]),_:2},1032,["icon","active","onClick"])]))),128)),ye,(d(!0),p(A,null,I(o(a)[o(e).mode].options,_=>(d(),p("li",{key:_},[S(j,{icon:!1,active:o(e)[o(e).mode]===_,onClick:T=>o(e)[o(e).mode]=_},{default:C(()=>[D(b(_),1)]),_:2},1032,["active","onClick"])]))),128))])])])]))}});function xe(r){const n=V({currentWordIndex:0,currentLetter:0,typedWord:[],currentlyTyping:""}),e=L(()=>r.value[n.currentWordIndex].text),a=L(()=>n.currentLetter>=e.value.length);return{typing:n,isTypingLastLetter:a,currentWord:e}}const Te={class:"typing-area w-full md:w-2/3 my-3 select-none py-10 text-6xl mx-auto",tabindex:"0"},ke=R({__name:"Area",props:{words:null},setup(r){const n=r,e=L(()=>n.words),a=l(),f=l(),g=l(!1),{typing:t,currentWord:m,isTypingLastLetter:y}=xe(e),h=B(),{isTyping:v}=J(h);let i;const u=L(()=>{var k,w,$,M;const s=()=>({left:0,top:0,right:0,bottom:0});if(!g||!e.value[t.currentWordIndex])return s();const x=(k=e.value[t.currentWordIndex])==null?void 0:k.letters[t.currentLetter];if(y.value){const q=e.value[t.currentWordIndex].letters[t.currentLetter-1].el,z={left:q.offsetLeft,top:q.offsetTop,width:q.offsetWidth};return{left:z.left+a.value.offsetLeft+z.width,top:q.offsetTop*-1}}return((w=x==null?void 0:x.el)==null?void 0:w.getBoundingClientRect())?{left:x.el.offsetLeft-((M=($=a.value)==null?void 0:$.offsetLeft)!=null?M:0),top:x.el.offsetTop*-1}:s()}),_=L(()=>{const s={left:`${u.value.left-2}px`,top:`${-u.value.top+5}px`};return{animation:`${v.value?"none":"caretFlash"} .5s ease-in-out infinite alternate`,...s}}),T=L(()=>({top:`${u.value.top}px`})),N=s=>{if([" ","'","Tab","Alt"].includes(s.key)&&(s.preventDefault(),["Alt"].includes(s.key))||s.ctrlKey)return;if(s.key===" "){t.currentLetter=0,t.currentWordIndex++,t.currentlyTyping+=s.key;return}if(s.key==="Backspace"){const W=t.currentlyTyping;t.currentLetter===0?(t.currentWordIndex--,t.currentLetter=m.value.length):t.currentLetter--,t.currentlyTyping=W.slice(0,-1);return}["Shift","Control","Tab"].includes(s.key)||y.value&&s.key!==" "||y.value||(t.currentLetter++,t.currentlyTyping+=s.key,v.value=!0,clearTimeout(i),i=setTimeout(()=>{v.value=!1},2e3))},P=(s,x)=>{const W=e.value[s];if(s>t.currentWordIndex)return;const k=t.currentlyTyping.split(" ");let w="var(--sub-color)",$=!1;return k[s]&&k[s][x]&&($=k[s][x]===W.text[x],w=$?"var(--main-color)":"var(--error-color)"),{color:w}};return G(()=>{g.value=!0,document.body.addEventListener("keydown",N),O(()=>{document.body.removeEventListener("keydown",N)})}),(s,x)=>(d(),p("div",Te,[c("div",{ref_key:"wordsWrapper",ref:f,class:"words-wrapper overflow-hidden relative h-[225px]"},[c("div",{ref_key:"wordsGroup",ref:a,class:"words flex flex-wrap absolute text-5xl",style:F(o(T))},[c("div",{class:"caret",style:F(o(_))},null,4),(d(!0),p(A,null,I(o(e),(W,k)=>(d(),p("div",{key:k,ref_for:!0,ref:w=>o(e)[k].el=w,class:"word"},[(d(!0),p(A,null,I(W.letters,(w,$)=>(d(),p("letter",{key:$,ref_for:!0,ref:M=>o(e)[k].letters[$].el=M,style:F(P(k,$))},b(w.text),5))),128))]))),128))],4)],512)]))}});const we=r=>r[Math.floor(Math.random()*r.length)],$e=()=>{const r=l([]),n=l([]),e=B(),a=L(()=>e.options.language),f=L(()=>e.config.mode),g=l(),t=l(),m=h=>({el:null,text:h,letters:h.split("").map(v=>({el:null,text:v}))});return{words:n,fetchWords:()=>new Promise((h,v)=>{console.log("current words",n.value);const i=f.value=="quote"?"quotes":"languages";fetch(`/${i}/${a.value}.json`,{cache:"force-cache"}).then(u=>u.json()).then(u=>{if(f.value=="quote")return n.value=[],g.value=u,t.value=we(g.value.quotes),n.value.push(...t.value.text.split(" ").map(T=>m(T))),console.log("quote chosen",n.value),h();if(r.value=u.words.map(T=>m(T)),f.value=="time")return n.value=r.value.sort(()=>.5-Math.random()),h();const _=e.config.words;return n.value=r.value.sort(()=>.5-Math.random()).slice(0,_),h()}).catch(u=>{console.log(u),v(),alert(`Language ${a.value} not found`)})}),quotes:g}},Le={key:0},be={key:1},We=R({__name:"index",setup(r){const{fetchWords:n,words:e}=$e(),a=B(),f=l(!1),g=l(!1),t=()=>{f.value=!1,n().then(()=>{f.value=!0})};X([()=>a.options.language,a.config],()=>{t()}),Y(()=>{t()});const m=y=>{y.key==="Tab"&&(y.preventDefault(),t())};return(y,h)=>{const v=de,i=he,u=ke;return d(),p("div",{class:"home",onKeyup:m},[o(g)?(d(),p("div",Le,[S(v)])):(d(),p("div",be,[S(i),S(Z,{name:"fade"},{default:C(()=>[o(f)?(d(),ee(u,{key:0,words:o(e)},null,8,["words"])):te("",!0)]),_:1})]))],32)}}});export{We as default};
