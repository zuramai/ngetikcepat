import{f as u,h as U,i as M,o as d,a as p,b as c,t as S,u as o,r as z,w as Q,v as H,j as K,k as R,l as J,m as L,p as V,q as G,e as W,s as B,x as D,F as I,y as N,z as O,A as X,B as E,C as Y,D as Z,T as ee,c as te,E as ne}from"./entry.e135bdd6.js";const oe=()=>{u(0);const r=u(0);u(0);const n=U([]),e=u(0),a=u(0);u(0);const f=u(0);let _,t;return{startRecording:()=>{a.value=performance.now();let v=0;_=setInterval(()=>{n.push({time:v,wpm:r.value}),v++,console.log(f.value)},1e3),t=setInterval(()=>{const l=(performance.now()-a.value)/1e3;f.value=l})},stopRecording:()=>{clearInterval(t),clearInterval(_)},getResult:()=>({wpm:r,accuracy:e})}},se={class:"container mx-auto my-12"},re={class:"result-header flex justify-center gap-20 text-center"},ce={class:"group"},ae=c("div",{class:"text-2xl mb-5"}," wpm ",-1),le={class:"text-7xl font-bold"},ie={class:"group"},ue=c("div",{class:"text-2xl mb-5"}," accuracy ",-1),de={class:"text-7xl font-bold"},fe=M({__name:"Result",setup(r){const{getResult:n}=oe(),e=n();return(a,f)=>(d(),p("div",se,[c("div",re,[c("div",ce,[ae,c("div",le,S(o(e).wpm),1)]),c("div",ie,[ue,c("div",de,S(o(e).accuracy)+"% ",1)])])]))}}),j=M({__name:"TextButton",props:{active:Boolean,icon:[String,Boolean]},emits:["click"],setup(r){return(n,e)=>(d(),p("a",{href:"#",class:K(["text-button inline-block",[r.active===!0?"active":""]]),onClick:e[0]||(e[0]=a=>n.$emit("click"))},[z(n.$slots,"icon",{},()=>[Q(c("div",{class:K(r.icon)},null,2),[[H,r.icon||n.$slots.icon]])]),c("span",null,[z(n.$slots,"default")])],2))}});const pe={class:"typing-settings flex justify-center"},ve={class:"settings-card flex-grow-0 rounded-sm shadow-lg my-5 text-sm p-1"},ge=c("h4",{class:"px-3 text-xl font-bold my-2"}," Typing Options ",-1),_e={class:"modes"},me={class:"settings-list p-0 m-0 flex"},ye=c("li",{class:"separator"},null,-1),he=c("li",{class:"separator"},null,-1),xe=M({__name:"Settings",setup(r){const n=R(),{config:e,configModes:a}=R(),{nextTheme:f,changeTheme:_,currentTheme:t}=J(),m=u([]),y=L(()=>n.options.language);V(()=>{const i=G();console.log("config",i.baseUrl),$fetch(`${i.baseUrl}/languages/_list.json`).then(g=>{m.value=g})});const h=i=>{console.log("language changed to ",i),n.options.language=i},v=()=>{const i=m.value.findIndex(l=>l.name===y.value),g=i+1>=m.value.length?0:i+1;h(m.value[g].name)};return(i,g)=>(d(),p("div",pe,[c("div",ve,[ge,c("div",_e,[c("ul",me,[c("li",null,[W(j,{icon:"i-mdi:world",active:o(e).punctuation,onClick:v},{default:B(()=>[D(S(o(y)),1)]),_:1},8,["active"])]),c("li",null,[W(j,{icon:"i-mdi:palette",active:o(e).numbers,onClick:o(f)},{default:B(()=>[D(S(o(t)),1)]),_:1},8,["active","onClick"])]),ye,(d(!0),p(I,null,N(o(a),(l,k)=>(d(),p("li",{key:k},[W(j,{icon:l.icon,active:o(e).mode===k,onClick:b=>o(e).mode=k},{default:B(()=>[D(S(k),1)]),_:2},1032,["icon","active","onClick"])]))),128)),he,(d(!0),p(I,null,N(o(a)[o(e).mode].options,l=>(d(),p("li",{key:l},[W(j,{icon:!1,active:o(e)[o(e).mode]===l,onClick:k=>o(e)[o(e).mode]=l},{default:B(()=>[D(S(l),1)]),_:2},1032,["active","onClick"])]))),128))])])])]))}});function Te(r){const n=U({currentWordIndex:0,currentLetter:0,typedWord:[],currentlyTyping:""}),e=L(()=>r.value[n.currentWordIndex].text),a=L(()=>n.currentLetter>=e.value.length);return{typing:n,isTypingLastLetter:a,currentWord:e}}const ke={class:"typing-area w-full md:w-2/3 my-3 select-none py-10 text-6xl mx-auto",tabindex:"0"},we=M({__name:"Area",props:{words:null},setup(r){const n=r,e=L(()=>n.words),a=u(),f=u(),_=u(!1),{typing:t,currentWord:m,isTypingLastLetter:y}=Te(e),h=R(),{isTyping:v}=O(h);let i;const g=L(()=>{var T,w,$,q;const s=()=>({left:0,top:0,right:0,bottom:0});if(!_||!e.value[t.currentWordIndex])return s();const x=(T=e.value[t.currentWordIndex])==null?void 0:T.letters[t.currentLetter];if(y.value){const A=e.value[t.currentWordIndex].letters[t.currentLetter-1].el,F={left:A.offsetLeft,top:A.offsetTop,width:A.offsetWidth};return{left:F.left+a.value.offsetLeft+F.width,top:A.offsetTop*-1}}return((w=x==null?void 0:x.el)==null?void 0:w.getBoundingClientRect())?{left:x.el.offsetLeft-((q=($=a.value)==null?void 0:$.offsetLeft)!=null?q:0),top:x.el.offsetTop*-1}:s()}),l=L(()=>{const s={left:`${g.value.left-2}px`,top:`${-g.value.top+5}px`};return{animation:`${v.value?"none":"caretFlash"} .5s ease-in-out infinite alternate`,...s}}),k=L(()=>({top:`${g.value.top}px`})),b=s=>{if([" ","'","Tab","Alt"].includes(s.key)&&(s.preventDefault(),["Alt"].includes(s.key))||s.ctrlKey)return;if(s.key===" "){t.currentLetter=0,t.currentWordIndex++,t.currentlyTyping+=s.key;return}if(s.key==="Backspace"){const C=t.currentlyTyping;t.currentLetter===0?(t.currentWordIndex--,t.currentLetter=m.value.length):t.currentLetter--,t.currentlyTyping=C.slice(0,-1);return}["Shift","Control","Tab"].includes(s.key)||y.value&&s.key!==" "||y.value||(t.currentLetter++,t.currentlyTyping+=s.key,v.value=!0,clearTimeout(i),i=setTimeout(()=>{v.value=!1},2e3))},P=(s,x)=>{const C=e.value[s];if(s>t.currentWordIndex)return;const T=t.currentlyTyping.split(" ");let w="var(--sub-color)",$=!1;return T[s]&&T[s][x]&&($=T[s][x]===C.text[x],w=$?"var(--main-color)":"var(--error-color)"),{color:w}};return V(()=>{_.value=!0,document.body.addEventListener("keydown",b),X(()=>{document.body.removeEventListener("keydown",b)})}),(s,x)=>(d(),p("div",ke,[c("div",{ref_key:"wordsWrapper",ref:f,class:"words-wrapper overflow-hidden relative h-[225px]"},[c("div",{ref_key:"wordsGroup",ref:a,class:"words flex flex-wrap absolute text-5xl",style:E(o(k))},[c("div",{class:"caret",style:E(o(l))},null,4),(d(!0),p(I,null,N(o(e),(C,T)=>(d(),p("div",{key:T,ref_for:!0,ref:w=>o(e)[T].el=w,class:"word"},[(d(!0),p(I,null,N(C.letters,(w,$)=>(d(),p("letter",{key:$,ref_for:!0,ref:q=>o(e)[T].letters[$].el=q,style:E(P(T,$))},S(w.text),5))),128))]))),128))],4)],512)]))}});const $e=r=>r[Math.floor(Math.random()*r.length)],Le=()=>{const r=u([]),n=u([]),e=R(),a=L(()=>e.options.language),f=L(()=>e.config.mode),_=u(),t=u(),m=h=>({el:null,text:h,letters:h.split("").map(v=>({el:null,text:v}))});return{words:n,fetchWords:()=>new Promise((h,v)=>{console.log("current words",n.value);const i=f.value==="quote"?"quotes":"languages",g=G();fetch(`${g.baseUrl}/${i}/${a.value}.json`,{cache:"force-cache"}).then(l=>l.json()).then(l=>{if(f.value=="quote")return n.value=[],_.value=l,t.value=$e(_.value.quotes),n.value.push(...t.value.text.split(" ").map(b=>m(b))),console.log("quote chosen",n.value),h();if(r.value=l.words.map(b=>m(b)),f.value=="time")return n.value=r.value.sort(()=>.5-Math.random()),h();const k=e.config.words;return n.value=r.value.sort(()=>.5-Math.random()).slice(0,k),h()}).catch(l=>{console.log(l),v(),alert(`Language ${a.value} not found`)})}),quotes:_}},be={key:0},Se={key:1},Ce=M({__name:"index",setup(r){const{fetchWords:n,words:e}=Le(),a=R(),f=u(!1),_=u(!1),t=()=>{f.value=!1,n().then(()=>{f.value=!0})};Y([()=>a.options.language,a.config],()=>{t()}),Z(()=>{t()});const m=y=>{y.key==="Tab"&&(y.preventDefault(),t())};return(y,h)=>{const v=fe,i=xe,g=we;return d(),p("div",{class:"home",onKeyup:m},[o(_)?(d(),p("div",be,[W(v)])):(d(),p("div",Se,[W(i),W(ee,{name:"fade"},{default:B(()=>[o(f)?(d(),te(g,{key:0,words:o(e)},null,8,["words"])):ne("",!0)]),_:1})]))],32)}}});export{Ce as default};
